<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse Recipes</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="scripts/functions.js"></script>
    <script>
        //Fetch and display recipes from the server
        window.onload = async () => {
            const recipeList = document.getElementById('recipeList');
            try {
                const response = await fetch('http://localhost:3000/recipes');
                const recipes = await response.json();

                recipes.forEach(recipe => {
                    const article = document.createElement('article');
                    const capitalizedCategory = recipe.category.charAt(0).toUpperCase() + recipe.category.slice(1);
                    article.classList.add('recipe');
                    article.innerHTML = `
                    <img src="http://localhost:3000/${recipe.image_path}" alt="${recipe.title}">
                    <h3>${recipe.title}</h3>
                    <p><strong>Category:</strong> ${capitalizedCategory}</p>
                    <p>${recipe.description}</p>
                    <button class="edit-button" data-id="${recipe.id}">Edit</button>
                    <button class="delete-button" data-id="${recipe.id}">Delete</button>
                    `;
                    recipeList.appendChild(article);
                });
                // Add event listener for Edit button
                document.querySelectorAll('.edit-button').forEach(button => {
                button.addEventListener('click', handleEdit)});

                //Add event listener for Delete button
                document.querySelectorAll('.delete-button').forEach(button => {
                button.addEventListener('click', handleDelete);
                });
                
            } catch (error) {
                console.error('Error fetching recipes:', error);
                recipeList.innerHTML = '<p>Failed to load recipes. Please try again later.</p>';
            }
        };
    </script>
</head>

<body>
    <header>
        <div class="logo">
            <h1>RecipeShare</h1>
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Browse Recipes</a></li>
                <li><a href="favorites.html">Favorites</a></li>
                <li><a href="profile.html">Profile</a></li>
                <li><a href="upload.html">Post a Recipe</a></li>
                <li><a href="about.html">About Us</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <h2>Browse Recipes</h2>
        <form>
            <fieldset>
                <legend></legend>
                <div>
                    <label for="searchInput">Search:</label>
                    <input type="text" id="searchInput" placeholder="Search for a recipe...">
                </div>
            </fieldset>
        </form>

        <section class="recipes" id="recipeList">
            <!-- Recipes will be dynamically loaded here -->
        </section>
    </main>
</body>
</html>